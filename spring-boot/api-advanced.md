# API-Advanced

- 실전! 스프링 부트와 JPA 활용편 참고

## 권장순서

1. 엔티티 조회 방식으로 우선 접근

- 페치 조인으로 쿼리 수를 최적화, 컬렉션 최적화
- 페이징 필요 -> @BatchSize로 최적화
- 페이징 필요x -> 페치 조인 사용

2. 해결이 안되면 DTO 조회 방식 사용
3. 해결이 안되면 NativeSQL or Spring JdbcTemplate 사용

### 왜 엔티티 조회 방식을 먼저 권장하는가?

- @BatchSize, 페치 조인과 같이 코드를 거의 수정하지 않고 최적화 시도 가능<br/>
  -> 대부분의 경우 이 정도 선에서 충분한 최적화가 가능하다!
- DTO 조회 방식의 경우 많은 코드를 변경해야 함
- 성능 최적화와 코드 복잡도 사이의 줄타기는 개발자의 몫!!

## DTO 조회 방식

### JPA에서 DTO 직접 조회(V4)

- 코드가 단순하다
- 특정 주문 한건 조회의 경우 이 방식을 사용해도 성능이 잘 나온다

### 컬렉션 조회 최적화(V5)

- 여러 주문을 조회하는 경우 V5와 같은 방식 필요
- V4와 같은 방법으로 실행 시, 환경에 따라 어마무시한 성능차이 발생

### 플랫 데이터 최적화(V6)

- 완전히 다른 접근 방식
- 쿼리가 한번만 실행되어 보기엔 좋아보이나, 페이징이 불가하다
- 데이터가 많을 경우 중복 전송이 증가해서 V5와 성능차이도 미비하다
